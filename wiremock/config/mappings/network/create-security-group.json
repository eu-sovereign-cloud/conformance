{
    "name": "create-security-group",
    "priority": 10,
    "request": {
      "method": "PUT",
      "urlPathPattern": "/providers/seca.network/v1/tenants/([^/]+)/workspaces/([^/]+)/security-groups/([^/]+)",
      "headers": {
        "Content-Type": { "equalTo": "application/json" },
        "Accept": { "equalTo": "application/json" },
        "Authorization": { "matches": "Bearer .+" }
      },
      "bodyPatterns": [
        { "matchesJsonPath": "$[?(@.spec != null && @.spec.rules != null)]" }
      ]
    },
    "response": {
      "status": 201,
      "headers": { "Content-Type": "application/json" },
      "jsonBody": {
        "metadata": {
          "name": "{{request.pathSegments.[8]}}", "createdAt": "2025-07-25T08:25:00Z",
          "lastModifiedAt": "2025-07-25T08:25:00Z", "resourceVersion": 1,
          "tenant": "{{request.pathSegments.[4]}}", "region": "eu-central-1",
          "apiVersion": "v1", "kind": "security-group", "scope": "workspace/{{request.pathSegments.[6]}}",
          "resource": "seca.network/security-groups/{{request.pathSegments.[8]}}", "verb": "put",
          "workspace": "{{request.pathSegments.[6]}}"
        },
        "spec": { "rules": "{{jsonPath request.body '$.spec.rules'}}" },
        "status": {
          "conditions": [{ "state": "creating", "lastTransitionAt": "2025-07-25T08:25:00Z" }]
        }
      }
    }
  }